package iuh.fit.se.library;

import iuh.fit.se.library.search.*;
import java.util.List;
import iuh.fit.se.library.notification.*;

public class LibraryManagementSystem {

	public static void main(String[] args) {
		Library library = Library.getInstance();
		
		// Tạo Observers (Nhân viên thư viện và Người dùng)
        LibraryEventObserver staffObserver = new LibraryStaffObserver("Lan Anh");
        LibraryEventObserver userObserver = new UserObserver("Văn Nam");
        
        // Đăng ký Observers vào Library (Subject)
        library.registerObserver(staffObserver);
        library.registerObserver(userObserver);
		
		
		

        // Tạo sách với factory 
        Book book1 = BookFactory.createBook("Sách giấy", "Đắc Nhân Tâm", "Dale Carnegie", "Self-help", 250);
        Book book2 = BookFactory.createBook("Sách điện tử", "Tôi Thấy Hoa Vàng Trên Cỏ Xanh", "Nguyễn Nhật Ánh", "Văn học", "PDF");
        
        // Thêm sách mới vào thư viện (sẽ kích hoạt thông báo cho Observers)
        library.addBook(book1);
        System.out.println("---");
        library.addBook(book2);
        System.out.println("---");

        // 1. Tìm kiếm theo tiêu đề
        SearchStrategy titleSearch = new TitleSearchStrategy();
        List<Book> booksByTitle = library.searchBooks("hoa vàng", titleSearch);
        displayBooks(booksByTitle);
        System.out.println("---");

        // 2. Tìm kiếm theo tác giả
        SearchStrategy authorSearch = new AuthorSearchStrategy();
        List<Book> booksByAuthor = library.searchBooks("nguyễn nhật ánh", authorSearch);
        displayBooks(booksByAuthor);
        System.out.println("---");

        // 3. Tìm kiếm theo thể loại
        SearchStrategy genreSearch = new GenreSearchStrategy();
        List<Book> booksByGenre = library.searchBooks("fantasy", genreSearch);
        displayBooks(booksByGenre);

        // Demo list all books
        System.out.println("--- Danh sách tất cả sách ---");
        displayBooks(library.getAllBooks());
	}

	private static void displayBooks(List<Book> books) {
        if (books.isEmpty()) {
            System.out.println("Không tìm thấy sách phù hợp.");
        } else {
            System.out.println("Sách tìm thấy:");
            for (Book book : books) {
                book.displayBookInfo();
            }
        }
    }
}
